Mark and recapture is a method commonly used in ecology to estimate an animal population's size. A portion of the population is captured, marked, and released. Later, another portion is captured and the number of marked individuals within the sample is counted. Since the number of marked individuals within the second sample should be proportional to the number of marked individuals in the whole population, an estimate of the total population size can be obtained by dividing the number of marked individuals by the proportion of marked individuals in the second sample. The method is most useful when it is not practical to count all the individuals in the population. Other names for this method, or closely related methods, include capture-recapture, capture-mark-recapture, mark-recapture, sight-resight, mark-release-recapture, multiple systems estimation, band recovery, the Petersen method,  and the Lincoln method. Another major application for these methods is in epidemiology,  where they are used to estimate the completeness of ascertainment of disease registers. Typical applications include estimating the number of people needing particular services (i.e. services for children with learning disabilities, services for medically frail elderly living in the community), or with particular conditions(i.e. illegal drug addicts, people infected with HIV, etc.).  Typically a researcher visits a study area and uses traps to capture a group of individuals alive. Each of these individuals is marked with a unique identifier (e.g., a numbered tag or band), and then is released unharmed back into the environment.  A mark recapture method was first used for ecological study in 1896 by C.G. Johannes Petersen to estimate plaice, Pleuronectes platessa, populations.  Sufficient time is allowed to pass for the marked individuals to redistribute themselves among the unmarked population. Next, the researcher returns and captures another sample of individuals.  Some individuals in this second sample will have been marked during the initial visit and are now known as recaptures.  Other animals captured during the second visit, will not have been captured during the first visit to the study area.  These unmarked animals are usually given a tag or band during the second visit and then are released. Population size can be estimated from as few as two visits to the study area.  Commonly, more than two visits are made, particularly if estimates of survival or movement are desired.  Regardless of the total number of visits, the researcher simply records the date of each capture of each individual.  The "capture histories" generated are analyzed mathematically to estimate population size, survival, or movement. In the epidemiological setting, different sources of patients take the place of the repeated field visits in ecology. To take a concrete example, in establishing a register of children with Type 1 diabetes children were identified from hospital admission records, from general practitioners (family doctors), and from the records of the local Diabetes Association . None of these sources had a complete list, but by putting them together it was possible to do two things, first to see how many children were identified in total, and secondly to estimate how many more children with Type 1 diabetes were living in the vital community. Let A biologist wants to estimate the size of a population of turtles in a lake.  She captures 10 turtles on her first visit to the lake, and marks their backs with paint. A week later she returns to the lake and captures 15 turtles.  Five of these 15 turtles have paint on their backs, indicating that they are recaptured animals. This example is (n, K, k) = (10, 15, 5). The problem is to estimate N. The Lincoln–Petersen method  (also known as the Petersen–Lincoln index  or Lincoln index) can be used to estimate population size if only two visits are made to the study area.  This method assumes that the study population is "closed" .  In other words, the two visits to the study area are close enough in time so that no individuals die, are born, move into the study area (immigrate) or move out of the study area (emigrate) between visits.  The model also assumes that no marks fall off animals between visits to the field site by the researcher, and that the researcher correctly records all marks. Given those conditions, estimated population size is: It is assumed  that all individuals have the same probability of being captured in the second sample, regardless of whether they were previously captured in the first sample (with only two samples, this assumption cannot be tested directly). This implies that, in the second sample, the proportion of marked individuals that are caught (                        k                    /                  K                 {\displaystyle k/K}    ) should equal the proportion of the total population that is marked (                        n                    /                  N                 {\displaystyle n/N}    ). For example, if half of the marked individuals were recaptured, it would be assumed that half of the total population was included in the second sample. In symbols, A rearrangement of this gives the formula used for the Lincoln–Petersen method.  In the example (n, K, k) = (10, 15, 5) the Lincoln–Petersen method estimates that there are 30 turtles in the lake. The Lincoln–Peterson estimator is asymptotically unbiased as sample size approaches infinity, but is biased at small sample sizes.  An alternative less biased estimator of population size is given by the Chapman estimator:  The example (K, n, k) = (10, 15, 5) gives Note that the answer provided by this equation must be truncated not rounded. Thus, the Chapman method estimates 28 turtles in the lake. Surprisingly, Chapman's estimate was one conjecture from a range of possible estimators: "In practice, the whole number immediately less than (K+1)(n+1)/(k+1) or even Kn/(k+1) will be the estimate. The above form is more convenient for mathematical purposes." (see footnote, page 144). Chapman also found the estimator could have considerable negative bias for small Kn/N  (page 146), but was unconcerned because the estimated standard deviations were large for these cases. A Bayesian analysis  found that Chapman's estimator is the maximum a posteriori estimator for a situation when the first person searches for a fixed number of animals then marks and releases them, but the second person searches for as many animals as possible. An approximately unbiased variance of                                                                                 N                 ^                                                               C                                     {\textstyle {\hat {N}}_{C}}     can be estimated as: The moments of the hypergeometric equation studied by Chapman can be calculated exactly , giving the answers  discussed below. An approximate                         100         (         1         −         α         )         %                 {\displaystyle 100(1-\alpha )\%}     confidence interval for the population size N can be obtained as:                         K         +         n         −         k         +                                                (               K               −               k               +               0.5               )               (               n               −               k               +               0.5               )                                         (               k               +               0.5               )                                          exp         ⁡         (         ±                    z                        α                            /                          2                                                                                     σ                 ^                                                               0.5                             )                 {\displaystyle K+n-k+{\frac {(K-k+0.5)(n-k+0.5)}{(k+0.5)}}\exp(\pm z_{\alpha /2}{\hat {\sigma }}_{0.5})}    , where                                    z                        α                            /                          2                                     {\textstyle z_{\alpha /2}}     corresponds to the                         1         −         α                    /                  2                 {\displaystyle 1-\alpha /2}     quantile of a standard normal random variable, and                                                                                 σ                 ^                                                               0.5                             =                                                                 1                                    k                   +                   0.5                                                          +                                             1                                    K                   −                   k                   +                   0.5                                                          +                                             1                                    n                   −                   k                   +                   0.5                                                          +                                                                k                   +                   0.5                                                     (                   n                   −                   k                   +                   0.5                   )                   (                   K                   −                   k                   +                   0.5                   )                                                                                  {\displaystyle {\hat {\sigma }}_{0.5}={\sqrt {{\frac {1}{k+0.5}}+{\frac {1}{K-k+0.5}}+{\frac {1}{n-k+0.5}}+{\frac {k+0.5}{(n-k+0.5)(K-k+0.5)}}}}}    . It has been shown that this confidence interval has actual coverage probabilities that are close to the nominal                         100         (         1         −         α         )         %                 {\displaystyle 100(1-\alpha )\%}     level even for small populations and extreme capture probabilities (near to 0 or 1), in which cases other confidence intervals fail to achieve the nominal coverage levels.  A Bayesian analysis is provided by.  The final answer depends on the priors and the type of search assumed but the approach gives, for Chapman's assumptions (and changing variables from the original notation), A derivation is found here: Talk:Mark and recapture#Statistical treatment and (with different notation) in Ref.  ,  The example (K, n, k) = (10, 15, 5) gives the estimate  N ≈ 42 ± 21.5 The capture probability refers to the probability of a detecting an individual animal or person of interest,  and has been used in both ecology and epidemiology for detecting animal or human diseases,  respectively. The capture probability is often defined as a two-variable model, in which f is defined as the fraction of a finite resource devoted to detecting the animal or person of interest from a high risk sector of an animal or human population, and q is the frequency of time that the problem (e.g., an animal disease) occurs in the high-risk versus the low-risk sector.  For example, an application of the model in the 1920s was to detect typhoid carriers in London, who were either arriving from zones with high rates of tuberculosis (probability q that a passenger with the disease came from such an area, where q>0.5), or low rates (probability 1-q).  It was posited that only 5 out of every 100 of the travelers could be detected, and 10 out of every 100 were from the high risk area. Then the capture probability P was defined as:                         P         =                                 5             10                             f         q         +                                 5             90                             (         1         −         f         )         (         1         −         q         )                 {\displaystyle P={\frac {5}{10}}fq+{\frac {5}{90}}(1-f)(1-q)}    , where the first term refers to the probability of detection (capture probability) in a high risk zone, and the latter term refers to the probability of detection in a low risk zone. Importantly, the formula can be re-written as a linear equation in terms of f:                         P         =         (                                 5             10                             q         −                                 5             90                             (         1         −         q         )         )         f         +                                 5             90                             (         1         −         q         )                 {\displaystyle P=({\frac {5}{10}}q-{\frac {5}{90}}(1-q))f+{\frac {5}{90}}(1-q)}    . Because this is a linear function, it follows that for certain versions of q for which the slope of this line (the first term multiplied by f) is positive, all of the detection resource should be devoted to the high-risk population (f should be set to 1 to maximize the capture probability), whereas for other value of q, for which the slope of the line is negative, all of the detection should be devoted to the low-risk population (f should be set to 0. We can solve the above equation for the values of q for which the slope will be positive to determine the values for which f should be set to 1 to maximize the capture probability:                         (                                 5             10                             q         −                                 5             90                             (         1         −         q         )         )         >         0                 {\displaystyle ({\frac {5}{10}}q-{\frac {5}{90}}(1-q))>0}    , which simplifies to:                         q         >                                 1             10                                     {\displaystyle q>{\frac {1}{10}}}    . This is an example of linear optimization.  In more complex cases, where more than one resource f is devoted to more than two areas, multivariate optimization is often used, through the simplex algorithm or its derivatives. The literature on the analysis of capture-recapture studies has blossomed since the early 1990s . There are very elaborate statistical models available for the analysis of these experiments.  A simple model which easily accommodates the three source, or the three visit study, is to fit a Poisson regression model. Sophisticated mark-recapture models can be fit with several packages for the Open Source R programming language.  These include "Spatially Explicit Capture-Recapture (secr)",  "Loglinear Models for Capture-Recapture Experiments (Rcapture)",  and "Mark-Recapture Distance Sampling (mrds)".   Such models can also be fit with specialized programs such as MARK  or M-SURGE.  Other related methods which are often used include the Jolly–Seber model (used in open populations and for multiple census estimates) and Schnabel estimators  (described above as an expansion to the Lincoln–Peterson method for closed populations). These are described in detail by Sutherland.  Modelling mark-recapture data is trending towards a more integrative approach,  which combines mark-recapture data with population dynamics models and other types of data. The integrated approach is more computationally demanding, but extracts more information from the data improving parameter and uncertainty estimates.  