In statistics, originally in geostatistics, kriging or Gaussian process regression is a method of interpolation for which the interpolated values are modeled by a Gaussian process governed by prior covariances.  Under suitable assumptions on the priors, kriging gives the best linear unbiased prediction of the intermediate values.  Interpolating methods based on other criteria such as smoothness (e.g., smoothing spline) need not yield the most likely intermediate values.  The method is widely used in the domain of spatial analysis and computer experiments. The technique is also known as Wiener–Kolmogorov prediction, after Norbert Wiener and Andrey Kolmogorov. The theoretical basis for the method was developed by the French mathematician Georges Matheron in 1960, based on the Master's thesis of Danie G. Krige, the pioneering plotter of distance-weighted average gold grades at the Witwatersrand reef complex in South Africa. Krige sought to estimate the most likely distribution of gold based on samples from a few boreholes.  The English verb is to krige and the most common noun is kriging; both are often pronounced with a hard "g", following the pronunciation of the name "Krige". The word is sometimes capitalized as Kriging in the literature. The basic idea of kriging is to predict the value of a function at a given point by computing a weighted average of the known values of the function in the neighborhood of the point. The method is mathematically closely related to regression analysis. Both theories derive a best linear unbiased estimator, based on assumptions on covariances, make use of Gauss–Markov theorem to prove independence of the estimate and error, and make use of very similar formulae. Even so, they are useful in different frameworks: kriging is made for estimation of a single realization of a random field, while regression models are based on multiple observations of a multivariate data set. The kriging estimation may also be seen as a spline in a reproducing kernel Hilbert space, with the reproducing kernel given by the covariance function.  The difference with the classical kriging approach is provided by the interpretation: while the spline is motivated by a minimum norm interpolation based on a Hilbert space structure, kriging is motivated by an expected squared prediction error based on a stochastic model. Kriging with polynomial trend surfaces is mathematically identical to generalized least squares  polynomial curve fitting. Kriging can also be understood as a form of Bayesian inference.  Kriging starts with a prior distribution over functions. This prior takes the form of a Gaussian process:                         N                 {\displaystyle N}     samples from a function will be normally distributed, where the covariance between any two samples is the covariance function (or kernel) of the Gaussian process evaluated at the spatial location of two points. A set of values is then observed, each value associated with a spatial location. Now, a new value can be predicted at any new spatial location, by combining the Gaussian prior with a Gaussian likelihood function for each of the observed values. The resulting posterior distribution is also Gaussian, with a mean and covariance that can be simply computed from the observed values, their variance, and the kernel matrix derived from the prior. In geostatistical models, sampled data is interpreted as the result of a random process. The fact that these models incorporate uncertainty in their conceptualization doesn't mean that the phenomenon – the forest, the aquifer, the mineral deposit – has resulted  from a random process, but rather it allows one to build a methodological basis for the spatial inference of quantities in unobserved locations, and to quantify the uncertainty associated with the estimator. A stochastic process is, in the context of this model, simply a way to approach the set of data collected from the samples. The first step in geostatistical modulation is to create a random process that best describes the set of observed data. A value from location                                    x                        1                                     {\displaystyle x_{1}}     (generic denomination of a set of geographic coordinates) is interpreted as a realization                         z         (                    x                        1                             )                 {\displaystyle z(x_{1})}     of the random variable                         Z         (                    x                        1                             )                 {\displaystyle Z(x_{1})}    . In the space                         A                 {\displaystyle A}    , where the set of samples is dispersed, there are                         N                 {\displaystyle N}     realizations of the random variables                         Z         (                    x                        1                             )         ,         Z         (                    x                        2                             )         ,         …         ,         Z         (                    x                        N                             )                 {\displaystyle Z(x_{1}),Z(x_{2}),\ldots ,Z(x_{N})}    , correlated between themselves. The set of random variables constitutes a random function of which only one realization is known                         z         (                    x                        i                             )                 {\displaystyle z(x_{i})}     – the set of observed data. With only one realization of each random variable it's theoretically impossible to determine any statistical parameter of the individual variables or the function. For instance, if one assumes, based on the homogeneity of samples in area                         A                 {\displaystyle A}     where the variable is distributed, the hypothesis that the first moment is stationary (i.e. all random variables have the same mean), then one is assuming that the mean can be estimated by the arithmetic mean of sampled values. Judging such a hypothesis as appropriate is equivalent to assuming the sample values are sufficiently homogeneous . The hypothesis of stationarity related to the second moment is defined in the following way: the correlation between two random variables solely depends on the spatial distance between them, and is independent of their location.  Thus if                                    h                  =                    x                        2                             −                    x                        1                                     {\displaystyle \mathbf {h} =x_{2}-x_{1}}     and                                    |                             h                             |                  =         h                 {\displaystyle |\mathbf {h} |=h}     then: and, for simplicity, we define                         C         (                    x                        i                             ,                    x                        j                             )         =         C         (         Z         (                    x                        i                             )         ,         Z         (                    x                        j                             )         )                 {\displaystyle C(x_{i},x_{j})=C(Z(x_{i}),Z(x_{j}))}     and                         γ         (                    x                        i                             ,                    x                        j                             )         =         γ         (         Z         (                    x                        i                             )         ,         Z         (                    x                        j                             )         )                 {\displaystyle \gamma (x_{i},x_{j})=\gamma (Z(x_{i}),Z(x_{j}))}    .  This hypothesis allows one to infer those two measures – the variogram and the covariogram: where: Spatial inference, or estimation, of a quantity                         Z         :                                 R                                   n                             →                    R                          {\displaystyle Z\colon \mathbb {R} ^{n}\rightarrow \mathbb {R} }    , at an unobserved location                                    x                        0                                     {\displaystyle x_{0}}    , is calculated from a linear combination of the observed values                                    z                        i                             =         Z         (                    x                        i                             )                 {\displaystyle z_{i}=Z(x_{i})}     and weights                                    w                        i                             (                    x                        0                             )         ,                  i         =         1         ,         …         ,         N                 {\displaystyle w_{i}(x_{0}),\;i=1,\ldots ,N}    :                                                                Z               ^                                          (                    x                        0                             )         =                                 [                                                                                     w                                            1                                                                                                                  w                                            2                                                                                             ⋯                                                                          w                                            N                                                                                                  ]                             ⋅                                 [                                                                                     z                                            1                                                                                                                                                z                                            2                                                                                                                           ⋮                                                                                                        z                                            N                                                                                                  ]                             =                    ∑                        i             =             1                                   n                                        w                        i                             (                    x                        0                             )         ×         Z         (                    x                        i                             )                 {\displaystyle {\hat {Z}}(x_{0})={\begin{bmatrix}w_{1}&w_{2}&\cdots &w_{N}\end{bmatrix}}\cdot {\begin{bmatrix}z_{1}\\z_{2}\\\vdots \\z_{N}\end{bmatrix}}=\sum _{i=1}^{n}w_{i}(x_{0})\times Z(x_{i})}     The weights                                    w                        i                                     {\displaystyle w_{i}}     are intended to summarize two extremely important procedures in a spatial inference process: When calculating the weights                                    w                        i                                     {\displaystyle w_{i}}    , there are two objectives in the geostatistical formalism: unbias and minimal variance of estimation. If the cloud of real values                         Z         (                    x                        0                             )                 {\displaystyle Z(x_{0})}     is plotted against the estimated values                                                                Z               ^                                          (                    x                        0                             )                 {\displaystyle {\hat {Z}}(x_{0})}    , the criterion for global unbias, intrinsic stationarity or wide sense stationarity of the field, implies that the mean of the estimations must be equal to mean of the real values. The second criterion says that the mean of the squared deviations                         (                                                Z               ^                                          (         x         )         −         Z         (         x         )         )                 {\displaystyle ({\hat {Z}}(x)-Z(x))}     must be minimal, which means that when the cloud of estimated values versus the cloud real values is more disperse, the estimator is more imprecise. Depending on the stochastic properties of the random field and the various degrees of stationarity assumed, different methods for calculating the weights can be deduced, i.e. different types of kriging apply. Classical methods are: The unknown value                         Z         (                    x                        0                             )                 {\displaystyle Z(x_{0})}     is interpreted as a random variable located in                                    x                        0                                     {\displaystyle x_{0}}    , as well as the values of neighbors samples                         Z         (                    x                        i                             )         ,         i         =         1         ,         …         ,         N                 {\displaystyle Z(x_{i}),i=1,\ldots ,N}    . The estimator                                                                Z               ^                                          (                    x                        0                             )                 {\displaystyle {\hat {Z}}(x_{0})}     is also interpreted as a random variable located in                                    x                        0                                     {\displaystyle x_{0}}    , a result of the linear combination of variables. In order to deduce the kriging system for the assumptions of the model, the following error committed while estimating                         Z         (         x         )                 {\displaystyle Z(x)}     in                                    x                        0                                     {\displaystyle x_{0}}     is declared: The two quality criteria referred to previously can now be expressed in terms of the mean and variance of the new random variable                         ϵ         (                    x                        0                             )                 {\displaystyle \epsilon (x_{0})}    : Lack of bias: Since the random function is stationary,                         E         (         Z         (                    x                        i                             )         )         =         E         (         Z         (                    x                        0                             )         )         =         m                 {\displaystyle E(Z(x_{i}))=E(Z(x_{0}))=m}    , the following constraint is observed: In order to ensure that the model is unbiased, the weights must sum to one. Minimum variance: Two estimators can have                         E                    [                        ϵ             (                            x                                0                                         )                      ]                  =         0                 {\displaystyle E\left[\epsilon (x_{0})\right]=0}    , but the dispersion around their mean determines the difference between the quality of estimators. To find an estimator with minimum variance, we need to minimize                         E                    (                        ϵ             (                            x                                0                                                        )                                2                                                  )                          {\displaystyle E\left(\epsilon (x_{0})^{2}\right)}    . * see covariance matrix[not in citation given] for a detailed explanation * where the literals                                    {                                       Var                                                   x                                        i                                                                             ,                            Var                                                   x                                        0                                                                             ,                            Cov                                                   x                                        i                                                                        x                                        0                                                                                      }                          {\displaystyle \left\{\operatorname {Var} _{x_{i}},\operatorname {Var} _{x_{0}},\operatorname {Cov} _{x_{i}x_{0}}\right\}}     stand for                                    {                        Var             ⁡                            (                                                                        [                                                                                                Z                           (                                                        x                                                            1                                                                                   )                                                                             ⋯                                                                             Z                           (                                                        x                                                            N                                                                                   )                                                                                          ]                                                                        T                                               )                          ,             Var             ⁡             (             Z             (                            x                                0                                         )             )             ,             Cov             ⁡                            (                                                                                               [                                                                                                        Z                             (                                                            x                                                                1                                                                                         )                                                                                   ⋯                                                                                   Z                             (                                                            x                                                                N                                                                                         )                                                                                                  ]                                                                                T                                                     ,                 Z                 (                                    x                                        0                                                     )                              )                                   }                          {\displaystyle \left\{\operatorname {Var} \left({\begin{bmatrix}Z(x_{1})&\cdots &Z(x_{N})\end{bmatrix}}^{T}\right),\operatorname {Var} (Z(x_{0})),\operatorname {Cov} \left({\begin{bmatrix}Z(x_{1})&\cdots &Z(x_{N})\end{bmatrix}}^{T},Z(x_{0})\right)\right\}}    . Once defined the covariance model or variogram,                         C         (                    h                  )                 {\displaystyle C(\mathbf {h} )}     or                         γ         (                    h                  )                 {\displaystyle \gamma (\mathbf {h} )}    , valid in all field of analysis of                         Z         (         x         )                 {\displaystyle Z(x)}    , then we can write an expression for the estimation variance of any estimator in function of the covariance between the samples and the covariances between the samples and the point to estimate: Some conclusions can be asserted from this expression. The variance of estimation: Solving this optimization problem (see Lagrange multipliers) results in the kriging system: the additional parameter                         μ                 {\displaystyle \mu }     is a Lagrange multiplier used in the minimization of the kriging error                                    σ                        k                                   2                             (         x         )                 {\displaystyle \sigma _{k}^{2}(x)}     to honor the unbiasedness condition. Simple kriging is mathematically the simplest, but the least general.  It assumes the expectation of the random field to be known, and relies on a covariance function. However, in most applications neither the expectation nor the covariance are known beforehand. The practical assumptions for the application of simple kriging are: The kriging weights of simple kriging have no unbiasedness condition  and are given by the simple kriging equation system: This is analogous to a linear regression of                         Z         (                    x                        0                             )                 {\displaystyle Z(x_{0})}     on the other                                    z                        1                             ,         …         ,                    z                        n                                     {\displaystyle z_{1},\ldots ,z_{n}}    . The interpolation by simple kriging is given by: The kriging error is given by: which leads to the generalised least squares version of the Gauss–Markov theorem (Chiles & Delfiner 1999, p. 159): (Cressie 1993, Chiles&Delfiner 1999, Wackernagel 1995) Although kriging was developed originally for applications in geostatistics, it is a general method of statistical interpolation that can be applied within any discipline to sampled data from random fields that satisfy the appropriate mathematical assumptions.  It can be used where spatially-related data has been collected (in 2-D or 3-D) and estimates of "fill-in" data are desired in the locations (spatial gaps) between the actual measurements. To date kriging has been used in a variety of disciplines, including the following: Another very important and rapidly growing field of application, in engineering, is the interpolation of data coming out as response variables of deterministic computer simulations,  e.g. finite element method (FEM) simulations. In this case, kriging is used as a metamodeling tool, i.e. a black box model built over a designed set of computer experiments. In many practical engineering problems, such as the design of a metal forming process, a single FEM simulation might be several hours or even a few days long. It is therefore more efficient to design and run a limited number of computer simulations, and then use a kriging interpolator to rapidly predict the response in any other design point. Kriging is therefore used very often as a so-called surrogate model, implemented inside optimization routines.  